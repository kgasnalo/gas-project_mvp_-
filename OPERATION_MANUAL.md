# 採用参謀AI 運用マニュアル

**作成日:** 2025-11-19
**対象:** Phase 3.5以降
**バージョン:** 1.0

---

## 📋 目次

1. [システム概要](#1-システム概要)
2. [日次運用](#2-日次運用)
3. [週次運用](#3-週次運用)
4. [初回セットアップ](#4-初回セットアップ)
5. [トラブルシューティング](#5-トラブルシューティング)
6. [データメンテナンス](#6-データメンテナンス)
7. [よくある質問](#7-よくある質問)
8. [連絡先](#8-連絡先)

---

## 1. システム概要

### 1.1 承諾可能性計算エンジン

**計算式:**

```
【初回面談・社員面談】
承諾可能性 = 基礎要素(40%) + 関係性要素(30%) + 行動シグナル要素(30%)

【2次面接・内定後】
承諾可能性 = 基礎要素(40%) + 関係性要素(30%) + 行動シグナル要素(20%) + 自己申告要素(10%)
```

### 1.2 自動化の仕組み

```
アンケート送信（IMPORTRANGE経由）
    ↓
時間ベーストリガー（1時間ごと）
    ↓
新規回答をチェック
    ↓
承諾可能性計算
    ↓
Engagement_Logに記録
    ↓
Candidates_MasterのQUERY関数で集約
```

**重要:**
- このシステムはIMPORTRANGE経由でアンケートデータを取得します
- 時間ベーストリガーが1時間ごとに新規回答をチェックします
- Processing_Logシートで処理状況を追跡し、重複処理を防ぎます

---

## 2. 日次運用

### 2.1 朝のチェック（所要時間: 5分）

**チェック項目:**

1. **Processing_Logの確認**
   - Processing_Logシートを開く
   - 各フェーズの「Last Updated」が24時間以内であることを確認
   - 更新が止まっている場合はトリガーの動作を確認

2. **Error_Logの確認**
   - Error_Logシートを開く
   - Statusが「Unresolved」の行を確認
   - エラーがあれば対処

3. **Engagement_Logの確認**
   - 前日の新規エントリーを確認
   - 承諾可能性スコアが50点未満の候補者を確認
   - 必要に応じてフォローアップ

4. **アンケート回答状況の確認**
   - 各アンケートシートを開く
   - 未回答の候補者を確認
   - リマインドが必要か判断

### 2.2 夕方のレビュー（所要時間: 10分）

**実施内容:**

1. **承諾可能性の更新確認**
   - Candidates_Masterを開く
   - 「最新承諾可能性」列を確認
   - スコアが大幅に変動した候補者を確認

2. **人間の直感入力**
   - Engagement_LogのG列を確認
   - 面接を実施した候補者について入力
   - 1-10の数値で評価

3. **次のアクションの決定**
   - 承諾可能性が低い候補者へのフォロー
   - 面接スケジュールの調整
   - アンケートの送信

---

## 3. 週次運用

### 3.1 月曜日の定例作業（所要時間: 30分）

**実施内容:**

1. **自動化システムの健全性チェック**

   - Processing_Logで全フェーズが正常に動作していることを確認
   - 過去1週間のError_Logをレビュー
   - トリガーの実行履歴を確認（Apps Script > トリガー）

2. **週次レポートの作成**
   - Engagement_Logから過去1週間のデータを抽出
   - 承諾可能性の平均値を計算
   - 傾向分析

3. **AI予測 vs 人間の直感の分析**
   - F列（AI予測）とG列（人間の直感）を比較
   - ギャップが大きい候補者を抽出
   - スコアリングロジックの改善検討

4. **必要に応じて手動再計算**
   - 通常は自動化システムが処理するため不要
   - データに不整合がある場合のみ手動実行:
   ```javascript
   // AutomatedCheck.gsで実行
   resetProcessingLog();  // Processing_Logをリセット
   checkForNewSurveyResponses();  // 全データを再処理
   ```

---

## 4. 初回セットアップ

### 4.1 時間ベーストリガーの設定（初回のみ）

**所要時間: 5分**

時間ベース自動チェックを有効にするには、以下の手順でトリガーを設定してください。

#### **ステップ1: テスト実行**

1. Google Apps Scriptエディタを開く
2. `testAutomatedCheckSystem()` を実行
3. 実行ログで以下を確認:
   - Processing_Logシートが作成されたか
   - 自動チェックが正常に動作したか
   - エラーがないか

#### **ステップ2: トリガーの設定**

1. Google Apps Scriptエディタの左メニューから「トリガー」（時計アイコン）をクリック
2. 右下の「トリガーを追加」をクリック
3. 以下の設定を行う:

   | 項目 | 設定値 |
   |------|--------|
   | 実行する関数を選択 | `checkForNewSurveyResponses` |
   | 実行するデプロイを選択 | `Head` |
   | イベントのソースを選択 | `時間主導型` |
   | 時間ベースのトリガーのタイプを選択 | `時間ベースのタイマー` |
   | 時間の間隔を選択 | `1時間おき`（推奨） |

4. 「保存」をクリック

#### **ステップ3: 動作確認**

1. トリガー設定後、1時間待つ
2. Processing_Logシートを開く
3. 「Last Updated」が更新されていることを確認
4. Engagement_Logに新規エントリーがあれば確認

**重要な注意事項:**
- トリガーは1つだけ設定してください（重複トリガーは削除）
- 初回実行時に権限の承認が必要です
- 実行履歴はトリガー画面から確認できます

---

## 5. トラブルシューティング

### 5.1 よくある問題と対処法

#### **問題1: 新規アンケートがEngagement_Logに記録されない**

**原因:**
- 時間ベーストリガーが設定されていない
- トリガーがエラーで停止している
- Processing_Logの行番号が進んでいない

**対処法:**
1. Processing_Logシートを開いて「Last Updated」を確認
2. Google Apps Scriptのトリガー設定を確認
   - トリガー画面で `checkForNewSurveyResponses` が存在するか
   - 実行履歴にエラーがないか確認
3. Error_Logシートを確認
4. 手動でテスト実行: `testAutomatedCheckSystem()`

#### **問題2: 同じデータが重複してEngagement_Logに記録される**

**原因:**
- Processing_Logが正しく更新されていない
- 複数のトリガーが設定されている

**対処法:**
1. Processing_Logシートで行番号が更新されているか確認
2. トリガー設定画面で重複トリガーがないか確認
3. 必要に応じて `resetProcessingLog()` を実行してリセット

#### **問題3: 承諾可能性が常にデフォルト値になる**

**原因:**
- アンケート回答データがない
- メールアドレスが一致しない

**対処法:**
1. アンケートシートを開いて回答を確認
2. Candidates_MasterのEMAIL列を確認
3. メールアドレスが完全一致しているか確認（大文字小文字、スペースに注意）

#### **問題4: Error_Logにエラーが記録されている**

**対処法:**
1. Error MessageとError Stackを確認
2. 該当する関数を特定
3. ログを確認して原因を特定
4. 修正後、Statusを「Resolved」に変更

#### **問題5: Processing_Logシートが存在しない**

**対処法:**
1. `testAutomatedCheckSystem()` を実行
2. または `createProcessingLogSheet()` を手動実行
3. Processing_Logが自動作成されます

---

## 6. データメンテナンス

### 6.1 月次メンテナンス

**実施内容:**

1. **古いデータのアーカイブ**
   - Engagement_Logの3ヶ月以上前のデータを別シートに移動
   - Error_Logの「Resolved」ステータスのデータを削除

2. **データ整合性チェック**
   - Candidates_Masterの重複チェック
   - Engagement_Logの欠損値チェック
   - Contact_Historyの日付チェック

3. **スコアリングロジックの見直し**
   - 実際の内定承諾率とAI予測の相関分析
   - 重み付けの調整検討

---

## 7. よくある質問

**Q1: 承諾可能性はどのくらいの頻度で更新されますか？**

A: 時間ベーストリガーにより1時間ごとに自動チェックされます。新規アンケート回答があれば自動的にEngagement_Logに記録されます。手動で再処理する場合は、`checkForNewSurveyResponses()`を実行してください。

**Q2: 人間の直感（G列）は必須ですか？**

A: 必須ではありませんが、AI予測の精度検証に重要です。面接後24時間以内の入力を推奨します。

**Q3: スコアリングロジックを変更したい場合は？**

A: AcceptanceCalculation.gsの各関数の重み付けを変更してください。変更後は `resetProcessingLog()` と `checkForNewSurveyResponses()` を実行して全データを再計算してください。

**Q4: トリガーの実行間隔を変更できますか？**

A: はい。Google Apps Scriptのトリガー設定画面から変更できます。推奨は1時間ごとですが、候補者数が多い場合は30分ごとにすることも可能です。ただし、頻度を上げすぎるとAPI制限に達する可能性があります。

**Q5: Processing_Logをリセットするとどうなりますか？**

A: 全てのフェーズの最終処理行が0にリセットされます。次回の自動チェック時に全アンケートデータが再処理され、Engagement_Logに重複エントリーが作成されます。通常はリセット不要です。

**Q6: IMPORTRANGE元のスプレッドシートを変更したらどうなりますか？**

A: 自動的に新しいデータが反映されます。ただし、メールアドレスがCandidates_Masterと一致していることを確認してください。一致しない場合はEngagement_Logに記録されません。

---

## 8. 連絡先

**技術的な質問:**
- 開発者に連絡

**運用に関する質問:**
- 採用マネージャーに連絡

---

**以上、運用マニュアルでした。**
